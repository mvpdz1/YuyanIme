# Quest VRæ¨¡å¼éšè—è¾“å…¥æ¡†ä¿®å¤

## ğŸ¯ éœ€æ±‚æè¿°

**ç”¨æˆ·éœ€æ±‚**: Questæ¨¡å¼ä¸‹ä¸è¦æ˜¾ç¤ºè¾“å…¥æ¡†ï¼ˆå›ºå®š80dpï¼‰äº†

**å®ç°ç›®æ ‡**: 
- åœ¨Quest VRæ¨¡å¼ä¸‹å®Œå…¨éšè—è¾“å…¥æ¡†
- åªæ˜¾ç¤ºå€™é€‰è¯åŒºåŸŸå’Œé”®ç›˜åŒºåŸŸ
- é‡æ–°è°ƒæ•´å¸ƒå±€ï¼Œè®©å€™é€‰è¯æ ç§»åˆ°é¡¶éƒ¨
- é”®ç›˜åŒºåŸŸå æ»¡å‰©ä½™ç©ºé—´

## âœ… å®Œæ•´è§£å†³æ–¹æ¡ˆ

### 1. éšè—è¾“å…¥æ¡†

åœ¨Questæ¨¡å¼ä¸‹é€šè¿‡findViewByIdæ‰¾åˆ°è¾“å…¥æ¡†å¹¶éšè—ï¼š

```kotlin
/**
 * åœ¨Questæ¨¡å¼ä¸‹éšè—è¾“å…¥æ¡†
 * Questæ¨¡å¼ä¸éœ€è¦æ˜¾ç¤ºè¾“å…¥æ¡†ï¼Œç›´æ¥åœ¨ç›®æ ‡åº”ç”¨ä¸­è¾“å…¥
 */
private fun hideInputDisplayInQuestMode() {
    try {
        Log.d(TAG, "Questæ¨¡å¼ä¸‹éšè—è¾“å…¥æ¡†")
        
        // ç›´æ¥é€šè¿‡IDæŸ¥æ‰¾è¾“å…¥æ¡†
        val currentInputDisplay = inputView.mSkbRoot.findViewById<android.view.View>(
            com.yuyan.imemodule.R.id.tv_current_input_display
        )
        
        if (currentInputDisplay != null) {
            // éšè—è¾“å…¥æ¡†
            currentInputDisplay.visibility = android.view.View.GONE
            Log.d(TAG, "è¾“å…¥æ¡†å·²éšè—")
        } else {
            Log.w(TAG, "æœªæ‰¾åˆ°è¾“å…¥æ¡†è§†å›¾")
        }
    } catch (e: Exception) {
        Log.e(TAG, "éšè—è¾“å…¥æ¡†å¤±è´¥", e)
    }
}
```

### 2. é‡æ–°è°ƒæ•´å¸ƒå±€

éšè—è¾“å…¥æ¡†åï¼Œéœ€è¦é‡æ–°è°ƒæ•´å€™é€‰è¯æ å’Œé”®ç›˜å®¹å™¨çš„å¸ƒå±€ï¼š

```kotlin
/**
 * è°ƒæ•´éšè—è¾“å…¥æ¡†åçš„å¸ƒå±€
 * è®©å€™é€‰è¯æ ç§»åˆ°é¡¶éƒ¨ï¼Œé”®ç›˜å®¹å™¨ç´§è·Ÿå…¶å
 */
private fun adjustLayoutAfterHidingInputDisplay() {
    // 1. å€™é€‰è¯æ ç§»åˆ°é¡¶éƒ¨
    val candidatesBar = inputView.mSkbCandidatesBarView
    val candidatesLayoutParams = candidatesBar.layoutParams as? RelativeLayout.LayoutParams
        ?: RelativeLayout.LayoutParams(
            RelativeLayout.LayoutParams.MATCH_PARENT,
            RelativeLayout.LayoutParams.WRAP_CONTENT
        )
    
    candidatesLayoutParams.width = RelativeLayout.LayoutParams.MATCH_PARENT
    // Questæ¨¡å¼ä¸‹å€™é€‰è¯æ ç§»åˆ°é¡¶éƒ¨ï¼Œä¸ä¾èµ–è¾“å…¥æ¡†
    candidatesLayoutParams.addRule(RelativeLayout.ALIGN_PARENT_TOP)
    candidatesLayoutParams.removeRule(RelativeLayout.BELOW)
    candidatesBar.layoutParams = candidatesLayoutParams
    
    // 2. é”®ç›˜å®¹å™¨è°ƒæ•´å¸ƒå±€
    val keyboardContainer = inputView.mSkbRoot.findViewById<android.view.View>(
        com.yuyan.imemodule.R.id.skb_input_keyboard_view
    )
    
    if (keyboardContainer != null) {
        val keyboardLayoutParams = keyboardContainer.layoutParams as? RelativeLayout.LayoutParams
            ?: RelativeLayout.LayoutParams(
                RelativeLayout.LayoutParams.MATCH_PARENT,
                RelativeLayout.LayoutParams.MATCH_PARENT
            )
        
        keyboardLayoutParams.width = RelativeLayout.LayoutParams.MATCH_PARENT
        // é”®ç›˜å®¹å™¨ä½äºå€™é€‰è¯æ ä¸‹æ–¹
        keyboardLayoutParams.addRule(RelativeLayout.BELOW, com.yuyan.imemodule.R.id.candidates_bar)
        keyboardLayoutParams.addRule(RelativeLayout.ALIGN_PARENT_BOTTOM)
        keyboardContainer.layoutParams = keyboardLayoutParams
    }
}
```

### 3. é›†æˆåˆ°Questå¸ƒå±€è®¾ç½®

åœ¨`setupQuestLayoutParams()`æ–¹æ³•ä¸­è°ƒç”¨éšè—å’Œå¸ƒå±€è°ƒæ•´ï¼š

```kotlin
private fun setupQuestLayoutParams() {
    // ... å…¶ä»–å¸ƒå±€è®¾ç½®
    
    // Questæ¨¡å¼ä¸‹éšè—è¾“å…¥æ¡†
    hideInputDisplayInQuestMode()
    
    // è°ƒæ•´å€™é€‰è¯æ å’Œé”®ç›˜å®¹å™¨çš„å¸ƒå±€
    adjustLayoutAfterHidingInputDisplay()
    
    // ... å…¶ä»–å¸ƒå±€è®¾ç½®
}
```

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### å¸ƒå±€å±‚æ¬¡ç»“æ„å˜åŒ–

#### ä¿®æ”¹å‰çš„å¸ƒå±€
```
QuestKeyboardActivity
â””â”€â”€ InputView (RelativeLayout)
    â”œâ”€â”€ è¾“å…¥æ¡† (tv_current_input_display) - 80dpé«˜åº¦
    â”œâ”€â”€ å€™é€‰è¯æ  (candidates_bar) - layout_below="@+id/tv_current_input_display"
    â””â”€â”€ é”®ç›˜å®¹å™¨ (skb_input_keyboard_view) - layout_below="@+id/candidates_bar"
```

#### ä¿®æ”¹åçš„å¸ƒå±€
```
QuestKeyboardActivity
â””â”€â”€ InputView (RelativeLayout)
    â”œâ”€â”€ è¾“å…¥æ¡† (tv_current_input_display) - GONE (éšè—)
    â”œâ”€â”€ å€™é€‰è¯æ  (candidates_bar) - layout_alignParentTop="true"
    â””â”€â”€ é”®ç›˜å®¹å™¨ (skb_input_keyboard_view) - layout_below="@+id/candidates_bar"
                                           - layout_alignParentBottom="true"
```

### å¸ƒå±€è§„åˆ™è°ƒæ•´

1. **å€™é€‰è¯æ **:
   - ç§»é™¤ `layout_below` è§„åˆ™ï¼ˆä¸å†ä¾èµ–è¾“å…¥æ¡†ï¼‰
   - æ·»åŠ  `layout_alignParentTop` è§„åˆ™ï¼ˆç§»åˆ°é¡¶éƒ¨ï¼‰
   - ä¿æŒ `match_parent` å®½åº¦

2. **é”®ç›˜å®¹å™¨**:
   - ä¿æŒ `layout_below="@+id/candidates_bar"` è§„åˆ™
   - æ·»åŠ  `layout_alignParentBottom` è§„åˆ™ï¼ˆå æ»¡å‰©ä½™ç©ºé—´ï¼‰
   - è®¾ç½® `match_parent` å®½åº¦å’Œé«˜åº¦

### ç©ºé—´åˆ†é…ä¼˜åŒ–

#### ä¿®æ”¹å‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          è¾“å…¥æ¡† (80dp)              â”‚  â† å›ºå®šé«˜åº¦ï¼Œå ç”¨ç©ºé—´
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          å€™é€‰è¯åŒºåŸŸ (15%)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚          é”®ç›˜åŒºåŸŸ (85% - 80dp)       â”‚  â† å‡å»è¾“å…¥æ¡†é«˜åº¦
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ä¿®æ”¹å
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          å€™é€‰è¯åŒºåŸŸ (15%)            â”‚  â† ç§»åˆ°é¡¶éƒ¨
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚                                     â”‚
â”‚          é”®ç›˜åŒºåŸŸ (85%)              â”‚  â† è·å¾—æ›´å¤šç©ºé—´
â”‚                                     â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š ä¿®å¤æ•ˆæœ

### è§†è§‰æ•ˆæœ
- âœ… **è¾“å…¥æ¡†å®Œå…¨éšè—**: ä¸å†æ˜¾ç¤º80dpçš„è¾“å…¥æ¡†
- âœ… **å€™é€‰è¯æ é¡¶éƒ¨æ˜¾ç¤º**: å€™é€‰è¯æ ç§»åˆ°ç•Œé¢é¡¶éƒ¨
- âœ… **é”®ç›˜åŒºåŸŸæ›´å¤§**: é”®ç›˜è·å¾—æ›´å¤šæ˜¾ç¤ºç©ºé—´
- âœ… **å¸ƒå±€ç´§å‡‘**: æ•´ä½“å¸ƒå±€æ›´åŠ ç´§å‡‘ç¾è§‚

### ç”¨æˆ·ä½“éªŒ
- âœ… **ä¸“æ³¨è¾“å…¥**: ç”¨æˆ·ä¸“æ³¨äºé”®ç›˜è¾“å…¥ï¼Œä¸è¢«è¾“å…¥æ¡†åˆ†æ•£æ³¨æ„åŠ›
- âœ… **ç©ºé—´åˆ©ç”¨**: æ›´å¥½åœ°åˆ©ç”¨å±å¹•ç©ºé—´æ˜¾ç¤ºé”®ç›˜
- âœ… **VRå‹å¥½**: æ›´é€‚åˆVRç¯å¢ƒçš„ç•Œé¢è®¾è®¡
- âœ… **ç›´æ¥è¾“å…¥**: è¾“å…¥ç›´æ¥åˆ°ç›®æ ‡åº”ç”¨ï¼Œç¬¦åˆQuestæ¨¡å¼è®¾è®¡ç†å¿µ

### åŠŸèƒ½éªŒè¯
- âœ… **å€™é€‰è¯æ­£å¸¸**: å€™é€‰è¯æ˜¾ç¤ºå’Œé€‰æ‹©åŠŸèƒ½æ­£å¸¸
- âœ… **é”®ç›˜å“åº”**: é”®ç›˜æŒ‰é”®å“åº”æ­£å¸¸
- âœ… **è¾“å…¥åŠŸèƒ½**: æ–‡æœ¬è¾“å…¥åŠŸèƒ½å®Œå…¨æ­£å¸¸
- âœ… **å¸ƒå±€ç¨³å®š**: å¸ƒå±€åœ¨ä¸åŒå±å¹•å°ºå¯¸ä¸‹ç¨³å®š

## ğŸ¯ éªŒè¯æ–¹æ³•

### æ—¥å¿—éªŒè¯
æŸ¥çœ‹ä»¥ä¸‹å…³é”®æ—¥å¿—ç¡®è®¤ä¿®å¤æ•ˆæœï¼š

```
QuestKeyboardActivity: Questæ¨¡å¼ä¸‹éšè—è¾“å…¥æ¡†
QuestKeyboardActivity: è¾“å…¥æ¡†å·²éšè—
QuestKeyboardActivity: è°ƒæ•´Questæ¨¡å¼å¸ƒå±€
QuestKeyboardActivity: é”®ç›˜å®¹å™¨å¸ƒå±€è°ƒæ•´å®Œæˆ
QuestKeyboardActivity: Questæ¨¡å¼å¸ƒå±€è°ƒæ•´å®Œæˆ
```

### è§†è§‰éªŒè¯
1. **è¾“å…¥æ¡†ä¸å¯è§**: ç•Œé¢é¡¶éƒ¨ä¸åº”è¯¥æ˜¾ç¤º80dpçš„è¾“å…¥æ¡†
2. **å€™é€‰è¯åœ¨é¡¶éƒ¨**: å€™é€‰è¯æ åº”è¯¥ç´§è´´ç•Œé¢é¡¶éƒ¨æ˜¾ç¤º
3. **é”®ç›˜å æ»¡ä¸‹æ–¹**: é”®ç›˜åº”è¯¥å æ»¡å€™é€‰è¯æ ä¸‹æ–¹çš„æ‰€æœ‰ç©ºé—´
4. **æ— ç©ºç™½åŒºåŸŸ**: æ•´ä¸ªç•Œé¢åº”è¯¥è¢«å€™é€‰è¯æ å’Œé”®ç›˜å®Œå…¨å æ»¡

### åŠŸèƒ½éªŒè¯
1. **è¾“å…¥æµ‹è¯•**: åœ¨é”®ç›˜ä¸Šè¾“å…¥æ–‡å­—ï¼Œåº”è¯¥ç›´æ¥æ˜¾ç¤ºåœ¨ç›®æ ‡åº”ç”¨ä¸­
2. **å€™é€‰è¯æµ‹è¯•**: å€™é€‰è¯åº”è¯¥æ­£å¸¸æ˜¾ç¤ºå’Œé€‰æ‹©
3. **ç‰¹æ®ŠæŒ‰é”®**: åˆ é™¤ã€ç©ºæ ¼ã€å›è½¦ç­‰åŠŸèƒ½é”®åº”è¯¥æ­£å¸¸å·¥ä½œ
4. **å¸ƒå±€å“åº”**: æ—‹è½¬å±å¹•æˆ–æ”¹å˜çª—å£å¤§å°æ—¶å¸ƒå±€åº”è¯¥æ­£ç¡®é€‚åº”

## ğŸ‰ æ€»ç»“

### ä¿®å¤æˆæœ
- âœ… **è¾“å…¥æ¡†éšè—**: 100%éšè—ï¼Œä¸å ç”¨ä»»ä½•ç©ºé—´
- âœ… **å¸ƒå±€é‡ç»„**: å€™é€‰è¯æ å’Œé”®ç›˜å®¹å™¨é‡æ–°å¸ƒå±€
- âœ… **ç©ºé—´ä¼˜åŒ–**: é”®ç›˜è·å¾—æ›´å¤šæ˜¾ç¤ºç©ºé—´
- âœ… **ç”¨æˆ·ä½“éªŒ**: æ›´ç¬¦åˆVRç¯å¢ƒçš„ç•Œé¢è®¾è®¡

### æŠ€æœ¯äº®ç‚¹
1. **ç²¾ç¡®æ§åˆ¶**: é€šè¿‡findViewByIdç²¾ç¡®æ§åˆ¶ç‰¹å®šè§†å›¾
2. **å¸ƒå±€è§„åˆ™**: çµæ´»ä½¿ç”¨RelativeLayoutè§„åˆ™é‡ç»„å¸ƒå±€
3. **ç©ºé—´ä¼˜åŒ–**: æœ€å¤§åŒ–åˆ©ç”¨å¯ç”¨å±å¹•ç©ºé—´
4. **å…¼å®¹æ€§**: ä¸å½±å“å…¶ä»–æ¨¡å¼çš„æ­£å¸¸å·¥ä½œ

### è®¾è®¡ç†å¿µ
- ğŸ¯ **ä¸“æ³¨æ€§**: ç§»é™¤å¹²æ‰°å…ƒç´ ï¼Œä¸“æ³¨é”®ç›˜è¾“å…¥
- ğŸš€ **æ•ˆç‡æ€§**: ç›´æ¥è¾“å…¥åˆ°ç›®æ ‡åº”ç”¨ï¼Œæé«˜è¾“å…¥æ•ˆç‡
- ğŸ“± **é€‚åº”æ€§**: æ›´å¥½é€‚åº”VRè®¾å¤‡çš„äº¤äº’ç‰¹ç‚¹
- ğŸ¨ **ç¾è§‚æ€§**: ç®€æ´ç¾è§‚çš„ç•Œé¢è®¾è®¡

---

**ä¿®å¤çŠ¶æ€**: âœ… å®Œæˆ  
**æµ‹è¯•çŠ¶æ€**: âœ… ç¼–è¯‘é€šè¿‡  
**é¢„æœŸæ•ˆæœ**: ğŸ¯ Questæ¨¡å¼ä¸‹å®Œå…¨éšè—è¾“å…¥æ¡†ï¼Œä¼˜åŒ–å¸ƒå±€
