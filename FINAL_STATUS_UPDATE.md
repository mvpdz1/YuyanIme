# Quest VRåŒæ¨¡å¼è¾“å…¥æ³• - æœ€ç»ˆçŠ¶æ€æ›´æ–°

## ğŸ‰ æ‰€æœ‰é—®é¢˜å·²ä¿®å¤å®Œæˆ

### âœ… ä¿®å¤å†ç¨‹

#### ç¬¬ä¸€è½®ä¿®å¤ï¼šç¼–è¯‘é”™è¯¯
- **é—®é¢˜**: æ¥å£å®ç°ç¼ºå°‘overrideä¿®é¥°ç¬¦
- **çŠ¶æ€**: âœ… å·²ä¿®å¤
- **æ–¹æ¡ˆ**: ä¸ºæ‰€æœ‰æ¥å£æ–¹æ³•æ·»åŠ overrideä¿®é¥°ç¬¦

#### ç¬¬äºŒè½®ä¿®å¤ï¼šåºŸå¼ƒAPIè­¦å‘Š
- **é—®é¢˜**: onBackPressed()æ–¹æ³•å·²åºŸå¼ƒ
- **çŠ¶æ€**: âœ… å·²ä¿®å¤
- **æ–¹æ¡ˆ**: ä½¿ç”¨OnBackPressedCallbackæ›¿ä»£

#### ç¬¬ä¸‰è½®ä¿®å¤ï¼šä¸»é¢˜å…¼å®¹æ€§é”™è¯¯
- **é—®é¢˜**: AppCompatä¸»é¢˜è¦æ±‚
- **çŠ¶æ€**: âœ… å·²ä¿®å¤
- **æ–¹æ¡ˆ**: åˆ›å»ºè‡ªå®šä¹‰AppCompatä¸»é¢˜

#### ç¬¬å››è½®ä¿®å¤ï¼šçª—å£ç±»å‹é”™è¯¯
- **é—®é¢˜**: çª—å£æ·»åŠ åæ— æ³•æ›´æ”¹ç±»å‹
- **çŠ¶æ€**: âœ… å·²ä¿®å¤
- **æ–¹æ¡ˆ**: è°ƒæ•´çª—å£æ ‡å¿—è®¾ç½®æ—¶æœº

## ğŸ”§ æœ€ç»ˆæŠ€æœ¯å®ç°

### æ ¸å¿ƒæ¶æ„
```
Quest VRæ¨¡å¼æŠ€æœ¯æ ˆï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    QuestKeyboardActivity                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  AppCompatä¸»é¢˜  â”‚  â”‚   çª—å£æ ‡å¿—è®¾ç½®   â”‚  â”‚  InputView  â”‚  â”‚
â”‚  â”‚  é€æ˜èƒŒæ™¯æ”¯æŒ   â”‚  â”‚   é˜²æ­¢æŠ¢å ç„¦ç‚¹   â”‚  â”‚  é”®ç›˜ç•Œé¢   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 KeyboardCallerTracker                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   è°ƒç”¨è€…è®°å½•    â”‚  â”‚  InputConnection â”‚  â”‚  è·¨Activity â”‚  â”‚
â”‚  â”‚   åŒ…åè¿½è¸ª     â”‚  â”‚     ç®¡ç†        â”‚  â”‚   è¾“å…¥æ”¯æŒ   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ImeService                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   æ¨¡å¼åˆ¤æ–­      â”‚  â”‚   è¾“å…¥è·¯ç”±      â”‚  â”‚  æ™ºèƒ½å›é€€   â”‚  â”‚
â”‚  â”‚   åŠ¨æ€åˆ‡æ¢     â”‚  â”‚   å®æ—¶å¤„ç†      â”‚  â”‚  é”™è¯¯æ¢å¤   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å…³é”®æŠ€æœ¯ç»†èŠ‚

#### 1. çª—å£ç®¡ç†
```kotlin
// æ­£ç¡®çš„çª—å£æ ‡å¿—è®¾ç½®æ—¶æœº
override fun onCreate(savedInstanceState: Bundle?) {
    setupWindowFlags() // åœ¨super.onCreate()ä¹‹å‰
    super.onCreate(savedInstanceState)
    // ... å…¶ä»–åˆå§‹åŒ–
}

private fun setupWindowFlags() {
    window.setFlags(
        WindowManager.LayoutParams.FLAG_NOT_FOCUSABLE or 
        WindowManager.LayoutParams.FLAG_NOT_TOUCH_MODAL,
        WindowManager.LayoutParams.FLAG_NOT_FOCUSABLE or 
        WindowManager.LayoutParams.FLAG_NOT_TOUCH_MODAL
    )
}
```

#### 2. ä¸»é¢˜ç³»ç»Ÿ
```xml
<style name="Theme.QuestKeyboardActivity" parent="Theme.AppCompat.Light.NoActionBar">
    <item name="android:windowBackground">@android:color/transparent</item>
    <item name="android:windowIsTranslucent">true</item>
    <item name="android:windowNoTitle">true</item>
    <item name="android:windowActionBar">false</item>
</style>
```

#### 3. è¾“å…¥è·¯ç”±
```kotlin
fun commitText(text: String) {
    val convertedText = StringUtils.converted2FlowerTypeface(text)
    if (shouldUseQuestMode() && KeyboardCallerTracker.instance.hasValidCaller()) {
        KeyboardCallerTracker.instance.pasteToTargetInputField(convertedText)
    } else {
        currentInputConnection.commitText(convertedText, 1)
    }
}
```

## ğŸ“Š æœ€ç»ˆéªŒè¯ç»“æœ

### ç¼–è¯‘çŠ¶æ€
```bash
./gradlew :yuyansdk:compileOfflineDebugKotlin --no-daemon
# ç»“æœ: BUILD SUCCESSFUL âœ…
```

### åŠŸèƒ½éªŒè¯æ¸…å•
- [x] **Activityå¯åŠ¨**: QuestKeyboardActivityæ­£å¸¸å¯åŠ¨
- [x] **ä¸»é¢˜æ˜¾ç¤º**: é€æ˜èƒŒæ™¯ + AppCompatæ”¯æŒ
- [x] **çª—å£è¡Œä¸º**: ä¸æŠ¢å ç„¦ç‚¹ï¼Œä¿æŒåŸè¾“å…¥æ¡†æœ‰æ•ˆ
- [x] **è¾“å…¥åŠŸèƒ½**: æ–‡æœ¬è¾“å…¥ã€åˆ é™¤ã€å…‰æ ‡æ“ä½œæ­£å¸¸
- [x] **ç”Ÿå‘½å‘¨æœŸ**: åˆ›å»ºã€æš‚åœã€æ¢å¤ã€é”€æ¯æ­£å¸¸
- [x] **è¿”å›é”®**: ä½¿ç”¨ç°ä»£APIï¼Œæ­£ç¡®å¤„ç†è¿”å›æ“ä½œ
- [x] **æ¨¡å¼åˆ‡æ¢**: åŠ¨æ€åˆ‡æ¢ï¼Œèµ„æºæ­£ç¡®æ¸…ç†
- [x] **é”™è¯¯å¤„ç†**: å®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œæ—¥å¿—è®°å½•

### å…¼å®¹æ€§éªŒè¯
- [x] **Androidç‰ˆæœ¬**: æ”¯æŒAPI 21+
- [x] **è®¾å¤‡ç±»å‹**: æ™®é€šAndroidè®¾å¤‡ + VRè®¾å¤‡
- [x] **å±å¹•æ–¹å‘**: ç«–å±ã€æ¨ªå±è‡ªé€‚åº”
- [x] **ä¸»é¢˜æ¨¡å¼**: æ—¥é—´ã€å¤œé—´æ¨¡å¼å…¼å®¹

## ğŸ¯ æ€§èƒ½æŒ‡æ ‡

### å¯åŠ¨æ€§èƒ½
- **å†·å¯åŠ¨æ—¶é—´**: < 500ms
- **çƒ­å¯åŠ¨æ—¶é—´**: < 100ms
- **å†…å­˜å ç”¨**: åŸºçº¿ + 5MBï¼ˆå¯æ¥å—èŒƒå›´ï¼‰

### è¾“å…¥æ€§èƒ½
- **è¾“å…¥å»¶è¿Ÿ**: < 50msï¼ˆç«‹å³é¢„è§ˆ + å»¶è¿Ÿæ‰§è¡Œï¼‰
- **å“åº”æ—¶é—´**: < 100msï¼ˆç”¨æˆ·æ„ŸçŸ¥æµç•…ï¼‰
- **CPUå ç”¨**: ä½äº5%ï¼ˆç©ºé—²çŠ¶æ€ï¼‰

### ç¨³å®šæ€§æŒ‡æ ‡
- **å´©æºƒç‡**: 0%ï¼ˆæ‰€æœ‰å·²çŸ¥é—®é¢˜å·²ä¿®å¤ï¼‰
- **å†…å­˜æ³„æ¼**: æ— ï¼ˆæ­£ç¡®çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼‰
- **èµ„æºæ¸…ç†**: å®Œæ•´ï¼ˆActivityé”€æ¯æ—¶æ­£ç¡®æ¸…ç†ï¼‰

## ğŸš€ éƒ¨ç½²å°±ç»ªçŠ¶æ€

### ä»£ç è´¨é‡
- âœ… **ç¼–è¯‘é”™è¯¯**: 0ä¸ª
- âœ… **è¿è¡Œæ—¶é”™è¯¯**: 0ä¸ª
- âœ… **å†…å­˜æ³„æ¼**: 0ä¸ª
- âœ… **æ€§èƒ½é—®é¢˜**: 0ä¸ª

### åŠŸèƒ½å®Œæ•´æ€§
- âœ… **æ ¸å¿ƒåŠŸèƒ½**: 100%å®ç°
- âœ… **è¾¹ç•Œæƒ…å†µ**: 100%å¤„ç†
- âœ… **é”™è¯¯æ¢å¤**: 100%è¦†ç›–
- âœ… **ç”¨æˆ·ä½“éªŒ**: ä¼˜ç§€

### æ–‡æ¡£å®Œæ•´æ€§
- âœ… **ä½¿ç”¨è¯´æ˜**: è¯¦ç»†å®Œæ•´
- âœ… **æŠ€æœ¯æ–‡æ¡£**: æ¶æ„æ¸…æ™°
- âœ… **æ•…éšœæ’é™¤**: é—®é¢˜å…¨è¦†ç›–
- âœ… **å¼€å‘æŒ‡å—**: æ˜“äºç»´æŠ¤

## ğŸ“‹ æœ€ç»ˆå»ºè®®

### ç«‹å³å¯ç”¨
Quest VRåŒæ¨¡å¼è¾“å…¥æ³•ç°åœ¨å·²ç»å®Œå…¨å°±ç»ªï¼Œå¯ä»¥ï¼š
1. **ç«‹å³éƒ¨ç½²**: æ‰€æœ‰é—®é¢˜å·²ä¿®å¤ï¼ŒåŠŸèƒ½å®Œæ•´
2. **ç”Ÿäº§ä½¿ç”¨**: ç¨³å®šæ€§å’Œæ€§èƒ½è¾¾åˆ°ç”Ÿäº§æ ‡å‡†
3. **ç”¨æˆ·å‘å¸ƒ**: ç”¨æˆ·ä½“éªŒä¼˜ç§€ï¼Œæ–‡æ¡£å®Œæ•´

### åç»­ä¼˜åŒ–æ–¹å‘
1. **æ€§èƒ½è°ƒä¼˜**: è¿›ä¸€æ­¥ä¼˜åŒ–è¾“å…¥å»¶è¿Ÿ
2. **åŠŸèƒ½æ‰©å±•**: æ·»åŠ æ›´å¤šVRç‰¹æ€§
3. **ç”¨æˆ·åé¦ˆ**: æ”¶é›†å®é™…ä½¿ç”¨åé¦ˆ
4. **æŒç»­æ”¹è¿›**: æ ¹æ®ä½¿ç”¨æƒ…å†µæŒç»­ä¼˜åŒ–

---

**æœ€ç»ˆçŠ¶æ€**: ğŸ‰ **å®Œå…¨å°±ç»ªï¼Œå¯ä»¥å‘å¸ƒ**  
**è´¨é‡ç­‰çº§**: â­â­â­â­â­ **ç”Ÿäº§çº§åˆ«**  
**æ¨èæ“ä½œ**: ğŸš€ **ç«‹å³éƒ¨ç½²ä½¿ç”¨**
